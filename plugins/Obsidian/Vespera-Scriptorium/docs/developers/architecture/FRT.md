# 🧾 Functional Requirements Table

## 1. Foundational Module (Summarization)

| **Req ID** | **Status** | **Description**                             | **User Story**                                                                                                                                                  | **Expected Behavior / Outcome**                                                                                                                                      |
|------------|------------|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| FR001      | ✅         | File Discovery & Listing                    | As a user, I want to see all `.md`, `.txt`, `.html`, and `.csv` files in my Vault so I can choose which to summarize.                                          | Plugin lists matching files in a MultiSelectModal, showing name, path, and modified date.                                                                             |
| FR002      | ✅         | Multi-File Selection                        | As a user, I want to select multiple files at once so I can process them in a single operation.                                                                | Checkboxes beside each file allow bulk selection; "Summarize" button processes all checked items together.                                                            |
| FR003      | ✅         | Single-File Summarization                   | As a user, I want to right-click a file and choose "Summarize This File" for quick one-off summaries.                                                           | Context-menu command appears on file nodes; invoking it runs summarization on that single file only.                                                                 |
| FR004      | ✅         | Markdown/Text Parsing                       | As a user, I want `.md` and `.txt` content to be read verbatim so summaries reflect my source text.                                                           | Vault API's `read()` returns raw text; chunker operates directly on it.                                                                                                |
| FR005      | ✅         | HTML Parsing                                | As a user, I want HTML files to be cleaned into plain text so the LLM sees only relevant content.                                                             | Plugin uses `DOMParser` to strip tags and extract visible text before chunking.                                                                                        |
| FR006      | ✅         | CSV Parsing                                 | As a user, I want table data in `.csv` files to be converted to readable text so summaries capture key information.                                            | Bundled `papaparse` reads rows which are concatenated into paragraphs ("Column: Value; …") for chunking.                                                              |
| FR007      | ✅         | Text Chunking                               | As a user, I want large documents split into sentence- or paragraph-sized chunks so each fits the LLM's context window.                                        | LangChain.js `RecursiveTextSplitter` divides text on `\n\n`, `\n`, and sentence boundaries with configurable chunkSize/chunkOverlap.                                  |
| FR008      | ✅         | LLM Invocation                              | As a user, I want each chunk sent to my local Ollama or LM Studio model so I get coherent, AI-generated summaries.                                             | Plugin spawns `ollama run …` (or HTTP call) per chunk; collects and concatenates responses in order.                                                                 |
| FR009      | ✅         | Summary File Creation                       | As a user, I want summaries written back as `.md` files in a `/Summaries` folder so I can review them alongside my notes.                                       | Plugin creates files under `VaultRoot/Summaries/<original-filename>_summary.md` containing the aggregate summary text.                                               |
| FR010      | ✅         | Settings Panel                              | As a user, I want to configure chunk size, overlap, and optional spell-check so I can tailor summary granularity and cleanup.                                  | A settings modal or pane exposes controls for chunkSize, chunkOverlap, and a toggle "Clean up spelling/punctuation" before output.                                     |
| FR011      | ✅         | Progress Feedback                           | As a user, I want to see progress indicators so I know which file/chunk is being processed and when it's complete.                                             | Custom Pane or Notice displays "Processing file X of N… chunk Y of M…", with a spinner or progress bar.                                                               |
| FR012      | ✅         | Error Handling & Notifications              | As a user, I want clear error messages if parsing or LLM calls fail so I can take corrective action.                                                          | On failure, show a Notice with the file name and error details; summary of successes vs. failures at end of run.                                                     |
| FR013      | 🔄         | Prompt Template Management                  | As a user, I want to customize the prompts used for summarization so I can tailor the output to my specific needs.                                             | Template management system with variable substitution and conditional sections; ability to create and edit templates.                                                 |
| FR014      | 🔄         | Provider Selection                          | As a user, I want to choose between different LLM providers (Ollama, LM Studio) so I can use my preferred local model.                                         | Provider selection in settings; automatic detection of available models; capability reporting.                                                                        |
| FR015      | 🔄         | Streaming Support                           | As a user, I want to see summary results in real-time as they're generated so I can monitor progress and quality.                                              | Streaming implementation that processes chunks in real-time; progress visualization in the UI.                                                                        |

## 2. Core AI Retrieval & Interaction

| **Req ID** | **Status** | **Description**                             | **User Story**                                                                                                                                                  | **Expected Behavior / Outcome**                                                                                                                                      |
|------------|------------|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| FR101      | 📅         | Semantic Search Implementation              | As a user, I want to search my vault using natural language queries so I can find content based on meaning rather than keywords.                                | Compute embeddings for vault content; store in vector index; retrieve semantically similar content based on query embeddings.                                        |
| FR102      | 📅         | Search Results UI                           | As a user, I want search results displayed in a clear, ranked list so I can quickly find the most relevant content.                                             | Modal with search box and results list; highlighting of matching passages; ability to navigate to source files.                                                      |
| FR103      | 📅         | Conversational Assistant Pane               | As a user, I want a persistent chat interface that can answer questions about my vault content so I can quickly retrieve information.                           | Dockable pane with chat history; context-aware responses using semantic search for relevant content; ability to pin conversations.                                  |
| FR104      | 📅         | Vault-Scoped Conversations                  | As a user, I want to limit assistant conversations to specific parts of my vault so I can focus on relevant content.                                            | Options to scope conversations to entire vault, current workspace, or active note; clear indication of current scope.                                                |
| FR105      | 📅         | Inline Suggestion UI                        | As a user, I want to select text in my notes and get AI-powered suggestions for rewrites, expansions, or summaries.                                             | Right-click menu with options for different suggestion types; popup with results and action buttons (Insert, Replace, Append).                                       |
| FR106      | 📅         | Context-Aware Suggestions                   | As a user, I want inline suggestions to consider surrounding content so they maintain consistency with my writing style and topic.                              | Include surrounding paragraphs as context for the LLM; maintain consistent tone and terminology.                                                                     |

## 3. Structured "Codex" Content

| **Req ID** | **Status** | **Description**                             | **User Story**                                                                                                                                                  | **Expected Behavior / Outcome**                                                                                                                                      |
|------------|------------|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| FR201      | 📅         | Schema Definition System                    | As a user, I want to define JSON/YAML schemas for different entity types so I can maintain consistent structure across my notes.                                | `/schemas` folder for user-defined schemas; validation of schema files; UI for schema management.                                                                    |
| FR202      | 📅         | Template Generation                         | As a user, I want to generate new notes based on my schemas so I can quickly create consistently structured content.                                            | "New X Entry" commands for each schema type; scaffolding of frontmatter and sections based on schema definition.                                                     |
| FR203      | 📅         | Dataview Integration                        | As a user, I want to generate Dataview queries based on my schemas so I can easily list and filter my structured content.                                       | Commands to insert Dataview code blocks filtered by schema type; automatic field mapping based on schema properties.                                                 |
| FR204      | 📅         | Custom Codex Views                          | As a user, I want rich, custom views of my structured content so I can visualize and navigate my information more effectively.                                   | Custom panels for displaying schema-based content; sorting and filtering options; visual styling based on content type.                                              |
| FR205      | 📅         | Relationship Mapping                        | As a user, I want to visualize relationships between my structured content so I can understand connections and dependencies.                                     | Parse frontmatter fields to infer relationships; generate graph view filtered to show only relevant nodes and edges.                                                 |

## 4. Visual Planning & Organization

| **Req ID** | **Status** | **Description**                             | **User Story**                                                                                                                                                  | **Expected Behavior / Outcome**                                                                                                                                      |
|------------|------------|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| FR301      | 📅         | Kanban Board Generation                     | As a user, I want to automatically generate Kanban boards based on my structured content so I can visualize workflow and progress.                              | Integration with community Kanban plugin; mapping of frontmatter fields to columns; automatic updates when content changes.                                          |
| FR302      | 📅         | Timeline Visualization                      | As a user, I want to visualize dated entries on a scrollable timeline so I can understand chronological relationships.                                          | Timeline view of dated schema entries; ability to zoom and scroll; links to source notes.                                                                            |
| FR303      | 📅         | Outline Panel Integration                   | As a user, I want a collapsible tree view of my structured content categories so I can navigate my information hierarchy.                                       | Custom outline panel organized by schema type; collapsible sections; links to individual entries.                                                                    |
| FR304      | 📅         | Drag-and-Drop Organization                  | As a user, I want to reorganize my structured content through drag-and-drop so I can quickly adjust my information hierarchy.                                   | Drag-and-drop support in outline panel; automatic updating of frontmatter fields to reflect new organization.                                                        |

## 5. Project & Version Control Enhancements

| **Req ID** | **Status** | **Description**                             | **User Story**                                                                                                                                                  | **Expected Behavior / Outcome**                                                                                                                                      |
|------------|------------|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| FR401      | 📅         | Git Diff Summarization                      | As a user, I want AI-generated summaries of git changes so I can quickly understand what's changed since my last commit.                                        | Integration with Obsidian Git plugin; chunking and summarization of diffs; human-readable change notes.                                                              |
| FR402      | 📅         | Enhanced Version History UI                 | As a user, I want to see commit history alongside AI-generated summaries so I can navigate version history more effectively.                                     | Custom panel showing commit list and summaries; ability to view diffs and restore previous versions.                                                                 |
| FR403      | 📅         | Collaboration Tools                         | As a user, I want tools for real-time collaboration with conflict resolution so I can work with others on shared content.                                        | Integration with sync plugins; conflict detection and resolution suggestions; change tracking.                                                                       |
| FR404      | 📅         | Encryption Controls                         | As a user, I want to selectively encrypt sensitive notes so I can protect private information while sharing other content.                                       | Integration with community Encryption plugin; commands to encrypt/decrypt notes; visual indicators for encrypted content.                                            |

## 6. Extensibility & Advanced Features

| **Req ID** | **Status** | **Description**                             | **User Story**                                                                                                                                                  | **Expected Behavior / Outcome**                                                                                                                                      |
|------------|------------|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| FR501      | 📅         | Public API                                  | As a developer, I want to access core Vespera Scriptorium services from my own plugins so I can extend functionality without duplicating code.                   | Exported commands for core services (chunk, summarize, embed); documented API contracts; example code.                                                               |
| FR502      | 📅         | Hook System                                 | As a developer, I want to register hooks for key events so I can extend functionality at specific points in the workflow.                                        | Event system for plugin lifecycle events; ability to register callbacks for specific actions; documentation for available hooks.                                     |
| FR503      | 📅         | Theming & Customization                     | As a user, I want to customize the appearance of Vespera Scriptorium components so they match my preferred aesthetic.                                           | CSS variable overrides in settings; options for font sizes, panel widths, and colors; preview of changes.                                                            |
| FR504      | 📅         | AI-Driven Art Generation                    | As a user, I want to generate images based on my notes so I can visualize concepts and enhance my content.                                                      | Integration with local art generation tools; command to generate images from selected text; thumbnail gallery and insertion options.                                 |

## 🕓 Post-MVP Enhancements

| **Req ID** | **Status** | **Description**                             | **User Story**                                                                                                                                                  | **Expected Behavior / Outcome**                                                                                                                                        |
|------------|------------|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| FR601      | 📅         | Drag-and-Drop File Input                    | As a user, I want to drag files from the Explorer into the plugin pane so I can quickly queue them for summarization.                                          | Plugin pane accepts dropped files and adds them to the selection list with metadata.                                                                                   |
| FR602      | 📅         | Real-Time Summary Preview                   | As a user, I want to see each chunk's summary appear live so I can gauge quality and stop early if needed.                                                      | Preview pane streams chunk responses as they arrive, allowing mid-run cancellation or manual editing.                                                                   |
| FR603      | 📅         | Model & Profile Selection                   | As a user, I want to choose which Ollama or LM Studio model to use (and save presets) so I can balance speed vs. accuracy.                                      | Dropdown in settings lists available local models; user can save default profile per Vault.                                                                             |
| FR604      | 📅         | Spell-Check & Grammar Cleanup               | As a user, I want advanced cleanup options (grammar/style) so summaries feel polished without manual edits.                                                     | Additional toggles (e.g., "Grammar polish using LLM") that chain a second cleanup prompt before writing output.                                                        |
| FR605      | 📅         | Sentence vs. Paragraph Toggle                | As a user, I want to switch between sentence-based and paragraph-based chunking on the fly so I can optimize context usage.                                     | Radio buttons in settings to select "Sentence Split" or "Paragraph Split"; reflects immediately on next run.                                                             |
| FR606      | 📅         | Export to HTML / XLSX                       | As a user, I want optional exports to `.html` or `.xlsx` so I can share summaries in other formats.                                                            | "Export as…" command generates corresponding files via DOM-to-HTML serialization or `xlsx` library.                                                                     |
| FR607      | 📅         | Plugin Command Shortcuts                    | As a user, I want keyboard shortcuts for core commands (bulk summarize, single summarize, open settings) so I can work faster.                                  | Define default keybindings (e.g., Ctrl+Shift+S for "Summarize Selected Files") configurable in Obsidian's hotkey settings.                                             |
| FR608      | 📅         | Multi-Vault Support                         | As a user, I want to run summaries across multiple Vaults without reinstalling so I can manage separate projects seamlessly.                                   | Plugin settings allow adding Vault paths; command to switch context and apply same logic across them.                                                                  |
| FR609      | 📅         | Multi-Threaded / Queued Processing            | As a user, I want to queue multiple files and process them in parallel where possible so I minimize overall run time.                                            | Use Worker Threads or a task queue to manage multiple concurrent LLM calls, respecting GPU or CPU capacity.                                                              |
| FR610      | 📅         | Usage Analytics & Telemetry (Opt-in)        | As a user, I want anonymous usage stats so the author can improve performance and features over time.                                                           | Opt-in telemetry reports number of files processed, average time per file, and error rates; respects privacy with no content sent.                                       |

## ✔️ Recently Completed

- [x] VaultTreeView: Multi-select (mouse, keyboard, numpad)
- [x] Visual feedback for selected/partial/focused/hover states
- [x] Hide empty folders recursively
- [x] Keyboard navigation (arrows, space, enter, numpad)
- [x] Left-click selects files, toggles folders
- [x] LLM Client implementation with provider support for Ollama and LM Studio
- [x] Prompt Template Manager with variable substitution and conditional sections
- [x] Progress visualization for long-running operations
- [x] Streaming support for real-time feedback
